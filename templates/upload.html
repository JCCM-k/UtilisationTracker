{% extends "base.html" %}

{% block title %}Upload Data - HCM Utilization{% endblock %}

{% block extra_css %}
<style>
    .upload-zone {
        transition: all 0.3s;
        background-color: #f8f9fa;
        min-height: 200px;
    }
    
    .upload-zone:hover {
        background-color: #e9ecef;
    }
    
    .upload-zone.border-primary {
        border-color: #0d6efd !important;
        background-color: #cfe2ff;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="row">
    <div class="col-md-8 mx-auto">
      
      <!-- Step 1: Project Info -->
      <div class="card mb-4">
        <div class="card-header">
          <h5>Step 1: Project Information</h5>
        </div>
        <div class="card-body">
          <form id="projectInfoForm">
            <div class="mb-3">
              <label class="form-label">Customer Name *</label>
              <input type="text" class="form-control" name="customerName" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Project Name *</label>
              <input type="text" class="form-control" name="projectName" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Project Start Date</label>
              <input type="date" class="form-control" name="projectStartDate">
            </div>
          </form>
        </div>
      </div>
      
      <!-- Step 2: File Upload -->
      <div class="card mb-4">
        <div class="card-header">
          <h5>Step 2: Upload Excel File</h5>
        </div>
        <div class="card-body">
          <div class="upload-zone border-2 border-dashed rounded p-5 text-center" 
               id="dropZone">
            <i class="bi bi-cloud-upload fs-1 text-muted"></i>
            <p class="mt-3">Drag & drop Excel file here</p>
            <p class="text-muted">or</p>
            <input type="file" id="fileInput" accept=".xlsx,.xls" hidden>
            <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
              Choose File
            </button>
            <p class="text-muted mt-3 small">
              Accepted formats: .xlsx, .xls | Max size: 10MB
            </p>
          </div>
          
          <div id="fileInfo" class="mt-3 d-none">
            <div class="alert alert-success">
              <i class="bi bi-file-earmark-excel"></i>
              <span id="fileName"></span> (<span id="fileSize"></span>)
            </div>
          </div>
          
          <button class="btn btn-lg btn-success w-100 mt-3" 
                  id="uploadBtn" disabled onclick="uploadFile()">
            <i class="bi bi-upload"></i> Upload & Process
          </button>
        </div>
      </div>
      
      <!-- Upload Progress -->
      <div class="card mb-4 d-none" id="progressCard">
        <div class="card-header">
          <h5>Upload Status</h5>
        </div>
        <div class="card-body">
          <div class="progress mb-3" style="height: 30px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated" 
                 id="progressBar" style="width: 0%">0%</div>
          </div>
          <ul class="list-unstyled" id="statusMessages">
            <!-- Dynamic status messages -->
          </ul>
        </div>
      </div>
      
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/upload.js') }}"></script>
{% endblock %}